{% extends "_base.html" %}
{% block content %}
<div class="d-flex align-items-center mb-4">
  <a href="{{ url_for('messages.inbox') }}" class="btn btn-sm btn-outline-secondary me-2 d-lg-none">← Back</a>
  <h3 class="mb-0 fw-bold">Conversation with {{ other.name }}</h3>
</div>
<div class="card p-3">
  <div style="max-height:450px; overflow-y:auto" class="mb-3 p-2" aria-live="polite">
    {% for m in msgs %}
      <div class="mb-3 {% if m.sender_id==current_user.user_id %}text-end{% endif %}">
        <div class="d-inline-block p-3 rounded-4 shadow-sm max-w-75 {{ 'bg-danger text-white' if m.sender_id==current_user.user_id else 'bg-light' }}" style="max-width:75%;">
          <div class="mb-1">{{ m.content }}</div>
          <div class="small opacity-75">{{ m.timestamp.strftime('%Y-%m-%d %H:%M') }}</div>
        </div>
      </div>
    {% else %}
      <div class="text-center text-muted py-5">No messages yet. Start the conversation!</div>
    {% endfor %}
  </div>
  <form method="post" aria-label="Send message">
    {{ form.csrf_token }}
    <div class="input-group">
      {{ form.content(class="form-control", placeholder="Type a message…", rows="2") }}
      <button class="btn btn-brand">Send</button>
    </div>
  </form>
</div>
{% endblock %}
